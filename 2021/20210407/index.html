<!DOCTYPE html>
<html lang="zh-CN">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="《CUDA权威编程指南》笔记-1" />
    <meta name="hexo-theme-A4" content="v1.9.8" />
    <link rel="alternate icon" type="image/webp" href="/img/20250602032635.jpg">
    <title>Yann | 我愿做你光华中淡淡的一笔</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--注意：首页既不是post也不是page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--返回顶部css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--目录-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery-bundle.min.css">


   
        
<link rel="stylesheet" href="/css/custom.css">

    

<meta name="generator" content="Hexo 5.4.2"></head>
    
    

    
    



    
        <style>
            .paper-main{
                max-width:  1200px;
            }
        </style>

    
    




    
    <style>
        :root {
            --waline-theme-color: #323e74; 
            --waline-color: #323e74; 
            --waline-border-color: #323e74; 
            --waline-white: #323e74; 
            --waline-bgcolor-light: #f2fafc;  
        }
        body {
            color: #323e74;
            background: #eaeae8;
        }
        .post-md code {
            background: #e7f7f3;
            color: #7f688d; 
        }
        .post-md pre, .post-md .highlight {
            background: #e7f7f3;
            color: #7f688d; 
        }
        pre .string, pre .value, pre .inheritance, pre .header, pre .ruby .symbol, pre .xml .cdata {
            color: #323e74;
        }
        pre .number, pre .preprocessor, pre .built_in, pre .literal, pre .params, pre .constant {
            color: #323e74;
        }
        .year-font-color {
            color: #323e74 !important;
        }
        .wl-card span.wl-nick {
            color: #323e74; 
        }
        .wl-card .wl-badge {
            border: 1px solid #323e74;
            color: #323e74; 
        }
        .wl-btn {
            border: 1px solid #323e74; 
            color:  #323e74;  
        }
        .wl-btn.primary {
            color: #f2fafc; 
        }
        .wl-header label {
            color: #323e74;
        }
        a {
            color: #7f688d;
        }

        .post-md a {
            color: #7f688d;
        }

        .nav li a {
            color: #7f688d;
        }

        .archive-main a:link {
            color: #7f688d;
        }
        .archive-main a:visited {
            color: #767c7c; 
        }

        .archive li span {
            color: #323e74;
        }

        .post-main-title {
            color: #323e74;
        }

        .post-md h1,
        .post-md h2,
        .post-md h3,
        .post-md h4,
        .post-md h5,
        .post-md h6 {
            color: #323e74;
        }

        [data-waline] p {
            color: #323e74;
        }
        [data-waline] a {
            color: #323e74;
        } 
        .wl-sort li.active {
            color: #323e74;
        }

        .wl-card .wl-meta>span {
            background: #f2fafc;
        }

        .paper {
            background: #eaeae8;
        }

        .index-main {
            background: #f2fafc;
        }

        .paper-main {
            background: #f2fafc;
        }

        .wl-panel {
            background: #f2fafc;
        }

        .archive li:nth-child(odd) {
            background: #f2fafc;
            ;
        }

        .archive li:nth-child(even) {
            background: #f2fafc;
        }

        .post-md table tr:nth-child(odd) td {
            background: #f2fafc;
        }

        .post-md table tr:nth-child(even) td {
            background: #f2fafc;
        }

    
        .progress-wrap::after {
            color: #323e74; /* 箭头的颜色 */
        }
        .progress-wrap svg.progress-circle path {
	        stroke: #323e74; /* 边框的颜色 */
        }
        .progress-wrap::before {
	        background-image: linear-gradient(298deg, #7f688d, #7f688d); /* 鼠标滑过的箭头颜色 */
         }

        .return-to-last-progress-wrap::after {
            color: #323e74; /* 箭头的颜色 */
        }
        .return-to-last-progress-wrap svg.progress-circle path {
	        stroke: #323e74; /* 边框的颜色 */
        }
        .return-to-last-progress-wrap::before {
	        background-image: linear-gradient(298deg, #7f688d, #7f688d); /* 鼠标滑过的箭头颜色 */
         }

         .left-toc-container::-webkit-scrollbar-thumb {
            background-color: #323e74; /* 设置滚动条拖动块的颜色 */
        }

        .bs-docs-sidebar .nav>.active>a,
        .bs-docs-sidebar .nav>li>a:hover,
        .bs-docs-sidebar .nav>li>a:focus {
            color: #7f688d;
            border-left-color: #7f688d;
        }
        .bs-docs-sidebar .nav>li>a {
            color:  #323e74;
        }
    </style>

    
    <style>
        body {
            background-image: url(/img/3.jpg);
            background-attachment: fixed;  /* 背景固定，不随页面滚动 */
            background-repeat: no-repeat;  /* 防止背景图片重复 */
            background-size: cover;       /* 背景自适应大小，覆盖整个背景 */
            background-position: center;   /* 背景居中显示 */
        }
        .paper {
            background-image: url(/img/3.jpg);
            background-attachment: fixed;  /* 背景固定，不随页面滚动 */
            background-repeat: no-repeat;  /* 防止背景图片重复 */
            background-size: cover;       /* 背景自适应大小，覆盖整个背景 */
            background-position: center;   /* 背景居中显示 */
        }  
    </style>


    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        <script>
            const options = {
                bottom: '40px', // default: '32px'
                right: 'unset', // default: '32px'
                left: '42px', // default: 'unset'
                time: '0.3s', // default: '0.3s'
                mixColor: '#fff', // default: '#fff'
                backgroundColor: ' #eaeae8  ',  // default: '#fff'
                buttonColorDark: '#100f2c',  // default: '#100f2c'
                buttonColorLight: '#fff', // default: '#fff'
                saveInCookies: true, // default: true,
                label: '🌓', // default: ''
                autoMatchOsTheme: true // default: true
            }
            const darkmode = new Darkmode(options);
            darkmode.showWidget();
        </script>
        
        
            
                <div class="left-toc-container">
                    <nav id="toc" class="bs-docs-sidebar"></nav>
                </div>
            
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <style>
            .header-img {
                width: 56px;
                height: auto;
                object-fit: cover; /* 保持图片比例 */
                transition: transform 0.3s ease-in-out; 
                border-radius: 0; 
            }
            
        </style>
        <img 
            alt="^-^" 
            cache-control="max-age=86400" 
            class="header-img" 
            src="/img/20250602032635.jpg" 
        />
        <div class="header-content">
            <a class="logo" href="/">Yann</a> 
            <span class="description">人工智能、计算机、机器学习、linux、程序员</span> 
        </div>
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">首页</a></li>
            
        
            
                <li><a href="/list/">文章</a></li>
            
        
            
                <li><a href="/about/">关于</a></li>
            
        
            
                <li><a href="/tags/">标签</a></li>
            
        
            
                <li><a href="/categories/">分类</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--说明是文章post页面-->
                    
                        <div class="post-main">
    

    
        
            
                <div class="post-main-title" style="text-align: center;">
                    《CUDA权威编程指南》笔记-1
                </div>
            
        
      
    

    

        
            <div class="post-head-meta-center">
        
                
                    <span>最近更新：2021-06-04</span> 
                
                
                    
                        &nbsp; | &nbsp;
                    
                     <span>字数总计：2.8k</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span>阅读估时：10分钟</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span id="busuanzi_container_page_pv">
                        阅读量：<span id="busuanzi_value_page_pv"></span>次
                    </span>
                
            </div>
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%9F%BA%E4%BA%8ECUDA%E7%9A%84%E5%BC%82%E6%9E%84%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="post-toc-text">第一章  基于CUDA的异构并行计算</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="post-toc-text">并行计算</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B9%B6%E8%A1%8C%E6%80%A7"><span class="post-toc-text">并行性</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%95%B0%E6%8D%AE%E5%B9%B6%E8%A1%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1"><span class="post-toc-text">数据并行程序设计</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%9E%B6%E6%9E%84"><span class="post-toc-text">计算机架构</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BC%82%E6%9E%84%E8%AE%A1%E7%AE%97"><span class="post-toc-text">异构计算</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%BC%82%E6%9E%84%E6%9E%B6%E6%9E%84"><span class="post-toc-text">异构架构</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BC%82%E6%9E%84%E8%AE%A1%E7%AE%97%E8%8C%83%E4%BE%8B"><span class="post-toc-text">异构计算范例</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#CUDA%EF%BC%9A%E4%B8%80%E7%A7%8D%E5%BC%82%E6%9E%84%E8%AE%A1%E7%AE%97%E5%B9%B3%E5%8F%B0"><span class="post-toc-text">CUDA：一种异构计算平台</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#API"><span class="post-toc-text">API</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#CUDA%E7%A8%8B%E5%BA%8F"><span class="post-toc-text">CUDA程序</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E8%BF%9B%E9%98%B6"><span class="post-toc-text">进阶</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%94%A8GPU%E8%BE%93%E5%87%BA-Hello-World"><span class="post-toc-text">用GPU输出 Hello World</span></a></li></ol></li></ol>
            
        
        <div class=".article-gallery"><blockquote>
<p>CUDA是一种通用的并行计算平台和编程模型，是在C语言上扩展的。借助于CUDA，你可以像编写C语言程序一样实现并行算法。你可以在NIVDIA的GPU平台上用CUDA为多种系统编写应用程序，范围从嵌入式设备、平板电脑、笔记本电脑、台式机工作站到HPC集群。在CUDA编程平台中，GPU并不是一个独立运行的计算平台，而需要与CPU协同工作，可以看成是CPU的协处理器，因此当我们在说GPU并行计算时，其实是指的基于CPU+GPU的异构计算架构。在异构计算架构中，GPU与CPU通过PCIe总线连接在一起来协同工作，CPU所在位置称为为主机端（host），而GPU所在位置称为设备端（device）。</p>
</blockquote>
<span id="more"></span>
<h2 id="第一章-基于CUDA的异构并行计算"><a href="#第一章-基于CUDA的异构并行计算" class="headerlink" title="第一章  基于CUDA的异构并行计算"></a>第一章  基于CUDA的异构并行计算</h2><h3 id="并行计算"><a href="#并行计算" class="headerlink" title="并行计算"></a>并行计算</h3><ul>
<li>一个大的问题可以被分解成多个小问题，然后在不同的计算资源上并行处 理这些小问题。</li>
<li>并行计算的软件和硬件层面是紧密联系的。</li>
<li>事实上，并行计算通常涉及两个不同的计算技术领域。</li>
<li>串行编程和并行编程</li>
<li>大多数现代处理器的哈佛体系结构（Harvard architecture）</li>
<li>计算机架构（硬件方面）</li>
<li>并行程序设计（软件方面）</li>
</ul>
<hr>
<h3 id="并行性"><a href="#并行性" class="headerlink" title="并行性"></a>并行性</h3><ul>
<li><p>多层次的并行性设计是架构设计的驱动力。在应用程序中有两种基本的并行类型。</p>
<blockquote>
<p>CUDA编程非常适合解决数据并行计算的问题。本书的重点便是如何使用CUDA编程 解决数据并行问题。</p>
</blockquote>
</li>
</ul>
<h4 id="数据并行程序设计"><a href="#数据并行程序设计" class="headerlink" title="数据并行程序设计"></a>数据并行程序设计</h4><ul>
<li><ul>
<li>块划分（block partitioning）</li>
<li>周期划分（cyclic partitioning）</li>
<li>一组连续的数据被分到一个块内</li>
<li>每个数据块以任 意次序被安排给一个线程</li>
<li>线程通常在同一时间只处理一个数据块</li>
<li>更少的数据被分到一个块内</li>
<li>相邻的线程处理相邻的数据块</li>
<li>每个线程可以处理多个数据块</li>
<li>为一个待处理的线程选择一个新的块，就意味着要跳过和现有线程一样多的数据块</li>
<li>第一步是把数据依据线程进行划分，使每个线程处理一部分数据</li>
<li>利用多核系统对数据进行分配</li>
<li>利用多核系统对任务进行分配</li>
<li>任务并行</li>
<li>数据并行</li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/Bazingaliu/clouding@master/image-20210410133904604.png" class="gallery-item" style="box-shadow: none;"> <img src="https://cdn.jsdelivr.net/gh/Bazingaliu/clouding@master/image-20210410133904604.png" alt=""></a></p>
<h4 id="计算机架构"><a href="#计算机架构" class="headerlink" title="计算机架构"></a>计算机架构</h4><ul>
<li><p>弗林分类法（Flynn’s Taxonomy）</p>
</li>
<li><ul>
<li>降低延迟</li>
<li>提高带宽</li>
<li>提高吞吐量</li>
<li>延迟是一个操作从开始到完成所需要的时间，常用微秒来表示</li>
<li>延迟用来衡量完成一次操作的时间</li>
<li>带宽是单位时间内可 处理的数据量，通常表示为MB/s或GB/s。</li>
<li>吞吐量是单位时间内成功处理的运算数量，通常表示为gflops（即每秒十亿次的浮点运算数量），特别是在重点使用浮点计算的科学计算领域经常用到</li>
<li>而吞吐量用来衡量在给定的单位时 间内处理的操作量</li>
<li>单指令单数据（SISD）(传统计算机，一种串行架构)</li>
<li>单指令多数据（SIMD） (按串行逻辑思考但对并行数据操作实现并行加速，而其他细节则由编译器来负责)</li>
<li>多指令单数据（MISD） (每个核心通过使用多个指令流处理同一个数据流)</li>
<li>多指令多数据（MIMD）(多个核心使用多个指令流来异步处理多个数据流，从而实现空间上的并行性)</li>
<li>根据指令和数据进入CPU的方式</li>
<li>实现以下目的，架构取得了许多进展</li>
</ul>
</li>
</ul>
<ul>
<li><p>计算机架构也能根据内存组织方式进行进一步划分</p>
</li>
<li><ul>
<li><p>要么是与同一个物理内存相关联</p>
</li>
<li><p>要么共用一个低延迟的链路（如PCIExpress或PCIe）</p>
</li>
<li><p>多核架构已经永久地取代了单核架构</p>
</li>
<li><p>多线程、 MIMD（多指令多数据）、SIMD（单指令多数据），以及指令级并行。</p>
<p>NVIDIA公司称这 种架构为SIMT（单指令多线程）</p>
</li>
<li><p>“众核”（many-core）通常是指有很多核心（几十或几百个）的多核架构</p>
</li>
<li><p>GPU代表了一种众核架构，几乎包括了前文描述的所有并行结构：</p>
</li>
<li><p>这种系统常被称作集群</p>
</li>
<li><p>分布式内存的多节点系统</p>
</li>
<li><p>共享内存的多处理器系统</p>
</li>
</ul>
</li>
<li></li>
<li><p>GPU核心和CPU核心</p>
</li>
<li><ul>
<li>较轻，用于优化具有简单控制逻辑的数据并行任务，注重并行程序的吞吐量</li>
<li>较重，用来处理非常复杂的控制逻辑，以优化串行程序执行</li>
<li>两种核心是完全不同的</li>
<li>CPU核心</li>
<li>GPU核心</li>
</ul>
</li>
</ul>
<hr>
<h3 id="异构计算"><a href="#异构计算" class="headerlink" title="异构计算"></a>异构计算</h3><blockquote>
<p>GPU指的是离散的设备从同构系统到异构系统的转变是高性能计算 史上的一个里程碑。</p>
</blockquote>
<ul>
<li><p>同构计算使用的是同一架构下的一个或多个处理器来执行一个应用。</p>
</li>
<li><p>而异构计算则使用一个处理器架构来执行一个应用，为任务选择适合它的架构，使其最终对性能有所改进。</p>
</li>
<li><ul>
<li>系统的有效利用 受限于增加应用程序设计的复杂性</li>
</ul>
</li>
</ul>
<h4 id="异构架构"><a href="#异构架构" class="headerlink" title="异构架构"></a>异构架构</h4><ul>
<li><p>一个典型的异构计算节点</p>
</li>
<li><ul>
<li>GPU不 是一个独立运行的平台而是CPU的协处理器</li>
<li>通过PCIe总线与基于CPU的 主机相连来进行操作</li>
<li>两个多核CPU插槽（主机端）</li>
<li>两个或更多个的众核GPU （设备端）</li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/Bazingaliu/clouding@master/image-20210410134053193.png" class="gallery-item" style="box-shadow: none;"> <img src="https://cdn.jsdelivr.net/gh/Bazingaliu/clouding@master/image-20210410134053193.png" alt=""></a></p>
<ul>
<li><p>一个异构应用包括两个部分</p>
</li>
<li><ul>
<li><p>在计算密集型应用中，往往有很多并行数据的程序段。</p>
<p>GPU就是用来提高这些并行数据的执行速度的。</p>
</li>
<li><p>在设备端加载计算密集型任务之前，CPU代码负责管理设备端的环境、代码和数据。</p>
</li>
<li><p>主机代码（CPU上运行）</p>
</li>
<li><p>设备代码（GPU上运行）</p>
</li>
</ul>
</li>
<li><p>NVIDIA公司的GPU计算平台</p>
</li>
<li><ul>
<li>Fermi是Tesla系列产品中的一种，用作GPU加速器，近来在高性能计算中获得了广泛应用</li>
<li>Fermi之后的新一代GPU 计算架构Kepler，于2012年秋季发布，其处理能力相比以往的GPU有很大提升，并且提供 了新的方法来优化和提高GPU并行工作的执行，有望将高性能计算提升到新的高度</li>
<li>Tegra系列产品是专为移动和嵌入式设备而设计的，如平板电脑和手机</li>
<li>GeForce面向图形用户</li>
<li>Quadro用于专业绘图设计</li>
<li>Tesla用于大规模的并行计算</li>
</ul>
</li>
<li><p>描述GPU容量的两个重要特征</p>
</li>
<li><ul>
<li>CUDA核心数量</li>
<li>内存大小</li>
</ul>
</li>
<li><p>两种不同的指标来评估GPU的性能</p>
</li>
<li><ul>
<li>内存带宽是从内存中读取或写入数据的比率。</li>
<li>内存带宽通常用 GB/s表示。</li>
<li>峰值计算性能是用来评估计算容量的一个指标，通常定义为每秒能处理的单精度或双 精度浮点运算的数量.</li>
<li>峰值性能通常用GFlops（每秒十亿次浮点运算）或TFlops（每秒万 亿次浮点运算）来表示。</li>
<li>峰值计算性能</li>
<li>内存带宽</li>
</ul>
</li>
<li><p>计算能力</p>
</li>
<li><ul>
<li>NVIDIA使用一个术语“计算能力”（compute capability）来描述整个Tesla系列的GPU加 速器的硬件版本。</li>
</ul>
</li>
</ul>
<h3 id="异构计算范例"><a href="#异构计算范例" class="headerlink" title="异构计算范例"></a>异构计算范例</h3><blockquote>
<p>GPU计算并不是要取代CPU计算</p>
</blockquote>
<blockquote>
<p>Tip：这一段我就不写了，本章节的主要内容用一张图即可概括</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/Bazingaliu/clouding@master/image-20210410134140428.png" class="gallery-item" style="box-shadow: none;"> <img src="https://cdn.jsdelivr.net/gh/Bazingaliu/clouding@master/image-20210410134140428.png" alt=""></a></p>
<h3 id="CUDA：一种异构计算平台"><a href="#CUDA：一种异构计算平台" class="headerlink" title="CUDA：一种异构计算平台"></a>CUDA：一种异构计算平台</h3><h4 id="API"><a href="#API" class="headerlink" title="API"></a>API</h4><blockquote>
<p>CUDA提供了两层API来管理GPU设备和组织线程。</p>
<p>这两种API是相互排斥的，你必须使用两者之一，从两者中混合函数调用是不可能的。</p>
</blockquote>
<ul>
<li><p>CUDA驱动API</p>
</li>
<li><ul>
<li>驱动API是一种低级API，它相对来说较难编程</li>
<li>对于在GPU设备使用上提供了更多的控制</li>
</ul>
</li>
<li><p>CUDA运行时API</p>
</li>
<li><ul>
<li>运行时API是一个高级API</li>
<li>它在驱动API的上层实现</li>
<li>每个运行时API函数都被分解为更多传给驱动API的基本运算</li>
</ul>
</li>
</ul>
<blockquote>
<p>也就是说Runtime api 可以看作是由Driver api 封装而成的</p>
</blockquote>
<h4 id="CUDA程序"><a href="#CUDA程序" class="headerlink" title="CUDA程序"></a>CUDA程序</h4><ul>
<li><p>一个CUDA程序包含了以下两个部分的混合。</p>
</li>
<li><ul>
<li>在CPU上运行的主机代码</li>
<li>在GPU上运行的设备代码</li>
</ul>
</li>
</ul>
<ul>
<li><p>一个典型的CUDA编程结构包括5个主要步骤</p>
</li>
<li><ul>
<li>分配GPU内存</li>
<li>从CPU内存中拷贝数据到GPU内存</li>
<li>调用CUDA内核函数来完成程序指定的运算</li>
<li>将数据从GPU拷回CPU内存</li>
<li>释放GPU内存空间</li>
</ul>
</li>
</ul>
<h4 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h4><ul>
<li><p>数据局部性在并行编程中是一个非常重要的概念。</p>
</li>
<li><ul>
<li>时间局部性是指在相对较短的时间段内数据和/或资源的重用。</li>
<li>空间局部性是指在相对较接近的存储空间内数据元素的重用。</li>
<li>数据局部性指的是数据重用，以降低内存访问的延迟。</li>
<li>数据局部性有两种基本类型</li>
</ul>
</li>
<li><p>CUDA中有内存层次和线程层次的概念</p>
</li>
<li><ul>
<li><p>内存层次结构</p>
</li>
<li><p>线程层次结构</p>
</li>
<li><p>例如：</p>
<p>在CUDA编程模型中使用的共享内存（一个特殊的内存）。</p>
<p>共享内存可以视为 一个被软件管理的高速缓存，通过为主内存节省带宽来大幅度提高运行速度。</p>
<p>有了共享内存，你可以直接控制代码的数据局部性。</p>
</li>
</ul>
</li>
</ul>
<p><strong>编译环境</strong>：本代码将使用<code>nvcc</code>编译器来编译，你可以使用以下命令来检查CUDA是否正确安装:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ which nvcc</span><br><span class="line">/usr/local/cuda-8.0/bin/nvcc  # cuda-8.0 版本</span><br></pre></td></tr></table></figure>
<h3 id="用GPU输出-Hello-World"><a href="#用GPU输出-Hello-World" class="headerlink" title="用GPU输出 Hello World"></a>用GPU输出 Hello World</h3><p>不妨先写一个cuda C程序，命名为<code>helloFromGPU</code>，用它来输出字符串 “Hello World from GPU！”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">========================== 代码清单 1-1 Hello World from GPU (hello.cu) ==========================</span><br><span class="line">// hello.cu</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">__global__ void helloFromGPU (void) </span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;Hello World from GPU!\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">    // hello from cpu</span><br><span class="line">    printf(&quot;Hello World from CPU!\n&quot;);</span><br><span class="line"></span><br><span class="line">    helloFromGPU &lt;&lt;&lt;1, 10&gt;&gt;&gt;();</span><br><span class="line">    cudaDeviceReset();</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在linux终端下使用以下命令进行编译<a target="_blank" rel="noopener" href="https://github.com/YunYang1994/cuda-tutorial/blob/master/src/chapter01/hello.cu"><code>hello.cu</code></a>，然后执行程序得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ nvcc -arch sm_20 hello.cu -o hello</span><br><span class="line">$ ./hello</span><br><span class="line">Hello World from CPU!</span><br><span class="line">Hello World from GPU!</span><br><span class="line">Hello World from GPU!</span><br><span class="line">Hello World from GPU!</span><br><span class="line">Hello World from GPU!</span><br><span class="line">Hello World from GPU!</span><br><span class="line">Hello World from GPU!</span><br><span class="line">Hello World from GPU!</span><br><span class="line">Hello World from GPU!</span><br><span class="line">Hello World from GPU!</span><br><span class="line">Hello World from GPU!</span><br></pre></td></tr></table></figure>
<p>在上面的代码中，<code>cudaDeviceReset</code>表示重置当前线程所关联过的当前设备的所有资源；修饰符<code>__global__</code>告诉编译器这是一个内核函数，它将从CPU中调用，然后在GPU上执行，在CPU上通过下面的代码启动内核函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helloFromGPU &lt;&lt;&lt;1, 10&gt;&gt;&gt;();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>三重尖号意味着从主线程到端代码的调用。1和10分别表示有1个块区域和10个线程，后续会作相关介绍。</p>
</blockquote>
</div>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2021-04-07</span>
            
                <span>该篇文章被 Yann</span>
            
            
                <span>打上标签:
                    
                    
                        <a href='/tags/CUDA/'>
                            CUDA
                        </a>
                    
                </span>
             
             
                <span>归为分类:
                    
                    
                        <a href='/categories/%E7%AC%94%E8%AE%B0/'>
                            笔记
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    
        
            
    
            <div class="post-footer-pre-next">
                
                    <span>上一篇：<a href='/2021/20210415/'>Tensorflow分布式实现-Kubernetes</a></span>
                

                
                    <span class="post-footer-pre-next-last-span-right">下一篇：<a href="/2021/20210406/">yolov5的openvino部署</a>
                    </span>
                
            </div>
    
        
    

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            © 1949-2025 China 

            
                

            
        </span>
       
    
</div>



<!--这是指一条线往下的内容-->
<div class="footer-last">
    
            <span>🌊看过大海的人不会忘记海的广阔🌊</span>
            
                <span class="footer-last-span-right"><i>本站由<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>驱动｜使用<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>主题</i></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--目录-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--回到顶部按钮-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery/lightgallery.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script>




<script type="text/javascript">
     
    if (typeof lightGallery !== "undefined") {
        var options1 = {
            selector: '.gallery-item',
            plugins: [lgThumbnail, lgFullscreen, lgAutoplay, lgZoom, lgRotate, lgPager], // 启用插件
            thumbnail: true,          // 显示缩略图
            zoom: true,               // 启用缩放功
            rotate: true,             // 启用旋转功能能
            autoplay: true,        // 启用自动播放功能
            fullScreen: true,      // 启用全屏功能
            pager: false, //页码,
            zoomFromOrigin: true,   // 从原始位置缩放
            actualSize: true,       // 启用查看实际大小的功能
            enableZoomAfter: 300,    // 延迟缩放，确保图片加载完成后可缩放
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1); // 修复选择器
    }
    
</script>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> 

                </div>
            
            
                <!-- 回到顶部的按钮-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- 返回的按钮-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>
<script src="/js/emojiHandler.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    wrapEmojis('.paper');
  });
</script>